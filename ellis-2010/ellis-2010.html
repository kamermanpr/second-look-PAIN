<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Peter Kamerman" />

<meta name="date" content="2016-02-22" />

<title>HIV neuropathy: down, but not out</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/htmlwidgets-0.7/htmlwidgets.js"></script>
<script src="site_libs/d3-3.5.14/d3.min.js"></script>
<link href="site_libs/customcss-0.0.1/html_ggiraph.css" rel="stylesheet" />
<script src="site_libs/ggiraph-binding-0.3.1/ggiraph.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #0000ff; } /* Keyword */
code > span.ch { color: #008080; } /* Char */
code > span.st { color: #008080; } /* String */
code > span.co { color: #008000; } /* Comment */
code > span.ot { color: #ff4000; } /* Other */
code > span.al { color: #ff0000; } /* Alert */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #008000; font-weight: bold; } /* Warning */
code > span.cn { } /* Constant */
code > span.sc { color: #008080; } /* SpecialChar */
code > span.vs { color: #008080; } /* VerbatimString */
code > span.ss { color: #008080; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { } /* Variable */
code > span.cf { color: #0000ff; } /* ControlFlow */
code > span.op { } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #ff4000; } /* Preprocessor */
code > span.do { color: #008000; } /* Documentation */
code > span.an { color: #008000; } /* Annotation */
code > span.cv { color: #008000; } /* CommentVar */
code > span.at { } /* Attribute */
code > span.in { color: #008000; } /* Information */
div.sourceCode {
  overflow-x: visible;
}
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">HIV neuropathy: down, but not out</h1>
<h4 class="author"><em>Peter Kamerman</em></h4>
<h4 class="date"><em>22 February 2016</em></h4>

</div>


<p>It has been a while since my last post <em>(Iâ€™ve been migrating the site from Wordpress to GitHub Pages)</em>, and I thought I would get back into the swing of things with a post on a topic close to my heart, <strong>HIV-associated sensory neuropathy</strong> (HIV-SN). The neuropathy <em>(damaged nerves)</em> affects the long sensory nerves from the hands and feet, producing reduced sensation. Somewhat counter-intuitively, this loss of sensation is often accompanied by chronic pain in the affected areas. The neuropathy is not fatal, but the loss of sensation, and particularly the pain, causes significant psychological, social, and economic problems for the person affected, their family/friends, and places a large burden on the healthcare system.</p>
<p>The mechanisms underlying the development of the neuropathy have not been clearly described, but one of the major risk factors for the neuropathy is exposure to older generation antiretroviral drugs <em>(ddX: stavudine, didanosine, zalcitabine)</em>, which are toxic to neurones. Imagine starting a treatment that saves your life, but potentially leaves you with chronic, intractable pain.</p>
<p>Because of their toxicity <em>(not just neuropathy, but a suite of other complications too)</em>, these older drugs were phased out of routine use in developed countries some time ago. More recently, there has been a steady shift away from using these drugs first-line in resource-poor countries too. With the global phasing out of neurotoxic ddX drugs, there is hope that the number of new cases of the neuropathy, and ultimately the total burden of the neuropathy, will fall. However, the epidemiological data to support this claim are scant. Head-to-head longitudinal efficacy and toxicological studies of old versus new antiretroviral treatments reported lower rates of the neuropathy in those people being treated with newer drugs, but these studies were poorly designed for detecting neuropathy in the first place. So where does that leave us in answering the question of whether we are witnessing the beginning of the end of HIV neuropathy?<br><br></p>
<div id="enter-the-charter-study" class="section level4">
<h4>Enter the CHARTER study</h4>
<p>One source of data that may shed light on problem is the National Institutes of Health (NIH)-funded CNS HIV Anti-Retroviral Therapy Effects Research <a href="http://www.charternntc.org">(CHARTER)</a> study. The study is a prospective, multi-centre study in the US reporting on central (brain and spinal cord) and peripheral nervous system complications of HIV infections in cross-sectional (~1600 participants) and longitudinal (~650 participants) cohorts; all participants undergo comprehensive neurological and neurobehavioural assessment. In 2010, Ronald Ellis and colleagues published a fascinating paper describing the prevalence of HIV neuropathy in 1539 HIV-infected individuals enrolled between 2003 and 2007 <em>(<a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3924778/">Ellis et al., Arch Neurol 67: 552-558, 2010. DOI: 10.1001/archneurol.2010.76</a>)</em>. They reported that <strong>57%</strong> (881/1539) of participants had HIV neuropathy <em>(defined as the presence of at least 1 abnormal clinical sign of neuropathy - reduced/absent vibration or pin-prick sensation in the feet and toes, or reduced ankle reflexes)</em>. But, despite providing the data (see Table 1 below) they did not report whether the prevalence of HIV neuropathy differed between patients depending on their exposure to neurotoxic antiretroviral drugs.<br><br></p>
<div class="figure">
<img src="figures/ellis-2010-table1.jpg" style="display:block;margin-right:auto;margin-left:auto;max-width:100%;" />

</div>
<p><br><br></p>
<p>Since the data are available, I saw an opportunity to look at whether the prevalence of HIV neuropathy did indeed differ between HIV-positive patients from the CHARTER study who were on combination antiretroviral therapy (cART), but who had <em>never been exposed</em> <strong>(ddX-naive)</strong> to neurotoxic ddX drugs, and those who <em>had been exposed</em> <strong>(ddX-exposed)</strong> at some time-point in their treatment.<br><br></p>
</div>
<div id="the-analysis" class="section level2">
<h2>The analysis</h2>
<div id="prevalence-of-hiv-sn" class="section level3">
<h3>Prevalence of HIV-SN</h3>
<p>The first step in the analysis involved extracting the relevant data from Table 1 of Ellis <em>et al.</em> (2010). Because the extraction only included a small number of data points I performed the extraction manually.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#       Extract data from Ellis et al (2010) table 1       #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># sn_ddX_exposed: Sensory neuropathy (sn), and have been exposed to ddX</span>
<span class="co"># Data extracted: Currently using ddX + used ddX in the past</span>
sn_ddX_exposed &lt;-<span class="st"> </span><span class="dv">138</span> +<span class="st"> </span><span class="dv">413</span>  

<span class="co"># sn_free_ddX_exposed: No sensory neuropathy (sn), and have been exposed to ddX  </span>
<span class="co"># Data extracted: Currently using ddX + used ddX in the past  </span>
sn_free_ddX_exposed &lt;-<span class="st"> </span><span class="dv">72</span> +<span class="st"> </span><span class="dv">175</span>  

<span class="co"># sn_ddX_naive: Sensory neuropathy (sn), and never been exposed to ddX  </span>
<span class="co"># Data extracted: ddX-naive - cART-naive  </span>
sn_ddX_naive &lt;-<span class="st"> </span><span class="dv">330</span> -<span class="st"> </span><span class="dv">71</span>  

<span class="co"># sn_free_ddX_naive: No sensory neuropathy (sn), and never been exposed to ddX  </span>
<span class="co"># Data extracted: ddX-naive - cART-naive  </span>
sn_free_ddX_naive &lt;-<span class="st"> </span><span class="dv">441</span> -<span class="st"> </span><span class="dv">163</span>  

############################################################
<span class="co">#                                                          #</span>
<span class="co">#                 Tabulate extracted data                  #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Put into dataframe</span>
extr &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">Neuropathy =</span> <span class="kw">c</span>(<span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>, <span class="st">&#39;No&#39;</span>),
                   <span class="dt">ddX_exposure =</span> <span class="kw">c</span>(<span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>),
                   <span class="dt">N =</span> <span class="kw">c</span>(sn_ddX_exposed, sn_ddX_naive, sn_free_ddX_exposed, sn_free_ddX_naive))

<span class="co"># Tabulate</span>
<span class="kw">pander</span>(extr, <span class="dt">caption =</span> <span class="st">&#39;Summary of data extracted from Table 1 of Ellis et al. (2010)&#39;</span>,
       <span class="dt">justify =</span> <span class="st">&#39;left&#39;</span>,
       <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table style="width:43%;">
<caption>Summary of data extracted from Table 1 of Ellis et al. (2010)</caption>
<colgroup>
<col width="18%" />
<col width="20%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Neuropathy</th>
<th align="left">ddX_exposure</th>
<th align="left">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Yes</td>
<td align="left">Yes</td>
<td align="left">551</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="left">No</td>
<td align="left">259</td>
</tr>
<tr class="odd">
<td align="left">No</td>
<td align="left">Yes</td>
<td align="left">247</td>
</tr>
<tr class="even">
<td align="left">No</td>
<td align="left">No</td>
<td align="left">278</td>
</tr>
</tbody>
</table>
<p>Once I had extracted the data, I used the data to construct simulated datasets of the number of participants with <em>(sn)</em> and without <em>(sn_free)</em> sensory neuropathy in the <strong>ddX-naive</strong> and <strong>ddX-exposed</strong> groups.<br><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#                    Simulate datasets                     #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># ddX-naive data</span>
ddX_naive &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;sn&#39;</span>, sn_ddX_naive), 
               <span class="kw">rep</span>(<span class="st">&#39;sn_free&#39;</span>, sn_free_ddX_naive)) %&gt;%<span class="st"> </span><span class="co"># generate the data</span>
<span class="st">    </span><span class="kw">sample</span>(., 
           <span class="dt">size =</span> <span class="kw">length</span>(.), 
           <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="co"># shuffle the pack (for no good reason)</span>

<span class="co"># ddX-exposed data </span>
ddX_exposed &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;sn&#39;</span>, sn_ddX_exposed), 
                 <span class="kw">rep</span>(<span class="st">&#39;sn_free&#39;</span>, sn_free_ddX_exposed))  %&gt;%<span class="st"> </span><span class="co"># generate the data</span>
<span class="st">    </span><span class="kw">sample</span>(., 
           <span class="dt">size =</span> <span class="kw">length</span>(.), 
           <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="co"># shuffle the pack (for no good reason)</span>

############################################################
<span class="co">#                                                          #</span>
<span class="co">#                Tabulate simulated data                   #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Put into dataframe</span>
sim &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">Group =</span> <span class="kw">c</span>(<span class="st">&#39;ddX_exposure&#39;</span>, <span class="st">&#39;ddX_naive&#39;</span>),
                     <span class="st">`</span><span class="dt">Neuropathy (n)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(ddX_exposed[ddX_exposed ==<span class="st"> &#39;sn&#39;</span>]), 
                                          <span class="kw">length</span>(ddX_naive[ddX_naive ==<span class="st"> &#39;sn&#39;</span>])),
                     <span class="st">`</span><span class="dt">No neuropathy (n)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(ddX_exposed[ddX_exposed ==<span class="st"> &#39;sn_free&#39;</span>]),
                                             <span class="kw">length</span>(ddX_naive[ddX_naive ==<span class="st"> &#39;sn_free&#39;</span>])),
                     <span class="st">`</span><span class="dt">Total (n)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(ddX_exposed),
                                     <span class="kw">length</span>(ddX_naive))) %&gt;%
<span class="st">    </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span> *<span class="st"> </span>(<span class="st">`</span><span class="dt">Neuropathy (n)</span><span class="st">`</span> /<span class="st"> `</span><span class="dt">Total (n)</span><span class="st">`</span>)))

<span class="co"># Tabulate</span>
<span class="kw">pander</span>(sim, <span class="dt">caption =</span> <span class="st">&#39;Summary of neuropathy prevalence in simulated datasets&#39;</span>,
       <span class="dt">justify =</span> <span class="st">&#39;left&#39;</span>,
       <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table>
<caption>Summary of neuropathy prevalence in simulated datasets</caption>
<colgroup>
<col width="16%" />
<col width="21%" />
<col width="25%" />
<col width="15%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Group</th>
<th align="left">Neuropathy (n)</th>
<th align="left">No neuropathy (n)</th>
<th align="left">Total (n)</th>
<th align="left">Prevalence (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ddX_exposure</td>
<td align="left">551</td>
<td align="left">247</td>
<td align="left">798</td>
<td align="left">69</td>
</tr>
<tr class="even">
<td align="left">ddX_naive</td>
<td align="left">259</td>
<td align="left">278</td>
<td align="left">537</td>
<td align="left">48</td>
</tr>
</tbody>
</table>
<p>With only a glance at the table above you can see that the prevalence of neuropathy in patients exposed to ddX at some time-point in their HIV treatment was greater than that in patients never exposed to any of the ddX drugs (69% vs 48%). But, these are point estimates of disease prevalence, based on the group of people who volunteered to take part in the study. It would be nice to get an estimate of the range of values within which the prevalence is estimated to lie by constructing 95% confidence intervals of the prevalence. A handy approach to generating these confidence intervals is <em>bootstrapping</em>; a resampling method that allows the generation of an estimate of a population parameter (e.g., disease prevalence) from sample data by resampling (with replacement) the sample data. It boils down to using the sample cohort as the population. There are several very good <em>R</em> packages that can be used to calculate bootstrap confidence intervals (the <em>â€˜bootâ€™</em> package by Brain Ripley and Angelo Canty springs to mind), but I chose to use perform the bootstrap use <em>base R</em> functions.<br><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#        Bootstrap SN prevalence (resampling = 999)        #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Step 1: Define function &#39;bootstrp&#39; to generate the 95% confidence </span>
<span class="co"># interval of the prevalence.</span>
<span class="co"># Generate a list (&#39;boot_resample&#39;) containing &#39;B&#39; bootstrap samples </span>
<span class="co"># of &#39;data&#39; (default = 999 samples)</span>
bootstrp &lt;-<span class="st"> </span>function(data, <span class="dt">B =</span> <span class="dv">999</span>){
    boot_resample &lt;-<span class="st"> </span><span class="kw">list</span>() <span class="co"># Create empty list</span>
    for(i in <span class="dv">1</span>:B){
    boot_resample[[i]] &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x =</span> data, 
                                 <span class="dt">size =</span> <span class="kw">length</span>(data), 
                                 <span class="dt">replace =</span> <span class="ot">TRUE</span>)
    }
    boot_resample
}

<span class="co"># Step 2: Run the function</span>
ddX_exposed_2 &lt;-<span class="st"> </span><span class="kw">bootstrp</span>(ddX_exposed)
ddX_naive_2 &lt;-<span class="st"> </span><span class="kw">bootstrp</span>(ddX_naive)

<span class="co"># The next two steps could have been included in the &#39;boostrp&#39; function, </span>
<span class="co"># but I decided to seperate them from the function to keep the </span>
<span class="co"># function simple, and make the process clearer.</span>

<span class="co"># Step 3: Create a vector of neuropathy prevalence data for each item </span>
<span class="co"># in the output of &#39;bootstrp&#39;</span>
ddX_exposed_3 &lt;-<span class="st"> </span><span class="kw">sapply</span>(ddX_exposed_2,
                          function(y) <span class="kw">round</span>(<span class="dv">100</span> *<span class="st"> </span>(<span class="kw">length</span>(y[y ==<span class="st"> &#39;sn&#39;</span>]) /<span class="st"> </span><span class="kw">length</span>(y))))
ddX_naive_3 &lt;-<span class="st"> </span><span class="kw">sapply</span>(ddX_naive_2,
                          function(y) <span class="kw">round</span>(<span class="dv">100</span> *<span class="st"> </span>(<span class="kw">length</span>(y[y ==<span class="st"> &#39;sn&#39;</span>]) /<span class="st"> </span><span class="kw">length</span>(y))))

<span class="co"># Step 4: Get the lower (0.025) and upper (0.975) limits of the </span>
<span class="co"># vector of prevalence data</span>
ddX_exposed_4 &lt;-<span class="st"> </span><span class="kw">quantile</span>(ddX_exposed_3,
                          <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))
ddX_naive_4 &lt;-<span class="st"> </span><span class="kw">quantile</span>(ddX_naive_3,
                        <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))

############################################################
<span class="co">#                                                          #</span>
<span class="co">#                Tabulate bootstrap outputs                #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Step 1: Prepare dataframe of simulated datasets (bootstrap sample)</span>
df &lt;-<span class="st"> </span><span class="kw">right_join</span>(<span class="kw">data_frame</span>(<span class="dt">N =</span> <span class="dv">1</span>:<span class="kw">length</span>(ddX_naive),
                             <span class="dt">ddX_naive =</span> <span class="kw">factor</span>(ddX_naive)),
                  <span class="kw">data_frame</span>(<span class="dt">N =</span> <span class="dv">1</span>:<span class="kw">length</span>(ddX_exposed),
                             <span class="dt">ddX_exposed =</span> <span class="kw">factor</span>(ddX_exposed))) %&gt;%<span class="st"> </span><span class="co"># make a dataframe</span>
<span class="st">    </span><span class="kw">gather</span>(Group, Neuropathy, ddX_naive, ddX_exposed) %&gt;%<span class="st"> </span><span class="co"># gather columns</span>
<span class="st">    </span><span class="kw">select</span>(Group, Neuropathy) %&gt;%<span class="st"> </span><span class="co"># select required columns</span>
<span class="st">    </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(Neuropathy)) %&gt;%<span class="st"> </span><span class="co"># remove NA from join</span>
<span class="st">    </span><span class="kw">group_by</span>(Group, Neuropathy) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">Count =</span> <span class="kw">n</span>()) %&gt;%<span class="st"> </span><span class="co"># get counts from group_by</span>
<span class="st">    </span><span class="kw">spread</span>(Neuropathy, Count) %&gt;%<span class="st"> </span><span class="co"># spread the Neuropathy column</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Total (n)</span><span class="st">`</span> =<span class="st"> </span>sn +<span class="st"> </span>sn_free,
           <span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span> *<span class="st"> </span>(sn /<span class="st"> `</span><span class="dt">Total (n)</span><span class="st">`</span>))) %&gt;%
<span class="st">    </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">Neuropathy (n)</span><span class="st">`</span>=<span class="st"> </span>sn, 
           <span class="st">`</span><span class="dt">No neuropathy (n)</span><span class="st">`</span> =<span class="st"> </span>sn_free) <span class="co"># rename columns</span>

<span class="co"># Step 2: Add the bootstrap CI data to &#39;df&#39;</span>
df2 &lt;-<span class="st"> </span>df %&gt;%
<span class="st">    </span><span class="kw">bind_cols</span>(<span class="kw">data.frame</span>(<span class="dt">Lower_95CI =</span> <span class="kw">c</span>(ddX_exposed_4[<span class="dv">1</span>], ddX_naive_4[<span class="dv">1</span>]),
                         <span class="kw">data.frame</span>(<span class="dt">Upper_95CI =</span> <span class="kw">c</span>(ddX_exposed_4[<span class="dv">2</span>], ddX_naive_4[<span class="dv">2</span>])))) %&gt;%
<span class="st">    </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">Lower 95% CI</span><span class="st">`</span> =<span class="st"> </span>Lower_95CI,
           <span class="st">`</span><span class="dt">Upper 95% CI</span><span class="st">`</span> =<span class="st"> </span>Upper_95CI)
<span class="co"># Step 3: Print table</span>
<span class="kw">pander</span>(df2, <span class="dt">caption =</span> <span class="st">&#39;Neuropathy prevalence (95% bootstrap confidence interval) in simulated datasets&#39;</span>,
       <span class="dt">justify =</span> <span class="st">&#39;left&#39;</span>,
       <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table>
<caption>Neuropathy prevalence (95% bootstrap confidence interval) in simulated datasets</caption>
<colgroup>
<col width="11%" />
<col width="15%" />
<col width="18%" />
<col width="11%" />
<col width="15%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Group</th>
<th align="left">Neuropathy (n)</th>
<th align="left">No neuropathy (n)</th>
<th align="left">Total (n)</th>
<th align="left">Prevalence (%)</th>
<th align="left">Lower 95% CI</th>
<th align="left">Upper 95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ddX_exposed</td>
<td align="left">551</td>
<td align="left">247</td>
<td align="left">798</td>
<td align="left">69</td>
<td align="left">66</td>
<td align="left">72</td>
</tr>
<tr class="even">
<td align="left">ddX_naive</td>
<td align="left">259</td>
<td align="left">278</td>
<td align="left">537</td>
<td align="left">48</td>
<td align="left">44</td>
<td align="left">53</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#                   Plot bootstrap data                    #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Step 1: Format &#39;df2&#39; for plotting, including tooltip columns for </span>
<span class="co"># interactive graph labelling</span>
Max &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">Max =</span> <span class="kw">c</span>(<span class="kw">max</span>(ddX_exposed_3), <span class="kw">max</span>(ddX_naive_3)))
Min &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">Min =</span> <span class="kw">c</span>(<span class="kw">min</span>(ddX_exposed_3), <span class="kw">min</span>(ddX_naive_3)))
tooltip_prev &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">tooltip_prev =</span> <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&#39;Point prevalence: &#39;</span>, 
                                                   df2$<span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span>[<span class="dv">1</span>], <span class="st">&#39;%&#39;</span>),
                                            <span class="kw">paste0</span>(<span class="st">&#39;Point prevalence: &#39;</span>, 
                                                   df2$<span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span>[<span class="dv">2</span>], <span class="st">&#39;%&#39;</span>)))
tooltip_95CI &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">tooltip_95CI =</span> <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&#39;Bootstrap 95% CI: &#39;</span>, df2$<span class="st">`</span><span class="dt">Lower 95% CI</span><span class="st">`</span>[<span class="dv">1</span>], 
                                                   <span class="st">&#39; to &#39;</span>, df2$<span class="st">`</span><span class="dt">Upper 95% CI</span><span class="st">`</span>[<span class="dv">1</span>], <span class="st">&#39;%&#39;</span>),
                                            <span class="kw">paste0</span>(<span class="st">&#39;Bootstrap 95% CI: &#39;</span>, df2$<span class="st">`</span><span class="dt">Lower 95% CI</span><span class="st">`</span>[<span class="dv">2</span>], 
                                                   <span class="st">&#39; to &#39;</span>, df2$<span class="st">`</span><span class="dt">Upper 95% CI</span><span class="st">`</span>[<span class="dv">2</span>], <span class="st">&#39;%&#39;</span>)))

df2_plot &lt;-<span class="st"> </span>df2 %&gt;%
<span class="st">    </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>:<span class="dv">7</span>)) %&gt;%
<span class="st">    </span><span class="kw">rename</span>(<span class="dt">Prevalence =</span> <span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span>,
           <span class="dt">Lower_95CI =</span> <span class="st">`</span><span class="dt">Lower 95% CI</span><span class="st">`</span>,
           <span class="dt">Upper_95CI =</span> <span class="st">`</span><span class="dt">Upper 95% CI</span><span class="st">`</span>) %&gt;%
<span class="st">    </span><span class="kw">bind_cols</span>(Max, Min, tooltip_prev, tooltip_95CI)

<span class="co"># Step 2: Set palette</span>
palette_dark &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#2a7eac&#39;</span>, <span class="st">&#39;#ac582a&#39;</span>)
palette_light &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#61add8&#39;</span>, <span class="st">&#39;#d88c61&#39;</span>)

<span class="co"># Step 3: Plot using interactive geoms from &#39;ggiraph&#39; package</span>
sn_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df2_plot,
                 <span class="kw">aes</span>(<span class="dt">x =</span> Group,
                     <span class="dt">y =</span> Prevalence,
                     <span class="dt">fill =</span> Group,
                     <span class="dt">color =</span> Group)) +
<span class="st">    </span><span class="kw">geom_rect_interactive</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Min, 
                      <span class="dt">ymax =</span> Max, 
                      <span class="dt">tooltip =</span> tooltip_95CI),
                      <span class="dt">xmin =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">1.75</span>), 
                      <span class="dt">xmax =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">2.25</span>)) +
<span class="st">    </span><span class="kw">geom_segment_interactive</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Prevalence,
                                 <span class="dt">yend =</span> Prevalence,
                                 <span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">1.75</span>), 
                                 <span class="dt">xend =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">2.25</span>),
                                 <span class="dt">tooltip =</span> tooltip_prev),
                             <span class="dt">size =</span> <span class="dv">3</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&#39;Neuropathy prevalence (%)</span><span class="ch">\n</span><span class="st">&#39;</span>) +
<span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Exposed</span><span class="ch">\n</span><span class="st">to ddX&#39;</span>, <span class="st">&#39;Never exposed</span><span class="ch">\n</span><span class="st">to ddx&#39;</span>)) +
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) +
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> palette_light) +
<span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> palette_dark) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>,
          <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;#dddddd&quot;</span>),
          <span class="dt">plot.title =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;#dddddd&quot;</span>),
          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),
          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>))

<span class="co"># Plot interactive graph</span>
extra_css &lt;-<span class="st"> &quot;background-color:#000000;color:#FFFFFF;font-family:helvetica;padding:10px;border-radius:10px 20px 10px 20px;&quot;</span>
<span class="kw">ggiraph</span>(<span class="dt">code =</span> <span class="kw">print</span>(sn_plot), 
        <span class="dt">tooltip_extra_css =</span> extra_css)</code></pre></div>
<div id="htmlwidget-eda2b7ba79c47b324448" style="width:960px;height:500px;" class="ggiraph html-widget"></div>
<script type="application/json" data-for="htmlwidget-eda2b7ba79c47b324448">{"x":{"html":"<?xml version='1.0' encoding='UTF-8'?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' id='svg_1' viewBox='0 0 432.00 432.00' width='432.00' height='432.00'><g><defs><clipPath id='cl1_0'><rect x='0.00' y='432.00' width='0.00' height='0.00'/>\u003c/clipPath>\u003c/defs><rect x='0.00' y='0.00' width='432.00' height='432.00' id='1' clip-path='url(#cl1_0)' fill=\"#FFFFFF\" fill-opacity=\"1\" stroke-width=\"0.75\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/><defs><clipPath id='cl1_1'><rect x='0.00' y='0.00' width='432.00' height='432.00'/>\u003c/clipPath>\u003c/defs><rect x='-0.00' y='0.00' width='432.00' height='432.00' id='2' clip-path='url(#cl1_1)' fill=\"#FFFFFF\" fill-opacity=\"1\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/><defs><clipPath id='cl1_2'><rect x='75.17' y='5.48' width='351.35' height='385.30'/>\u003c/clipPath>\u003c/defs><polyline points='75.17,329.48 426.52,329.48' id='3' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,241.91 426.52,241.91' id='4' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,154.34 426.52,154.34' id='5' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,66.78 426.52,66.78' id='6' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,373.26 426.52,373.26' id='7' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,285.70 426.52,285.70' id='8' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,198.13 426.52,198.13' id='9' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,110.56 426.52,110.56' id='10' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,22.99 426.52,22.99' id='11' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='170.99,390.78 170.99,5.48' id='12' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='330.70,390.78 330.70,5.48' id='13' clip-path='url(#cl1_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><rect x='131.07' y='117.57' width='79.85' height='31.52' id='14' clip-path='url(#cl1_2)' fill=\"#61ADD8\" fill-opacity=\"1\" stroke-width=\"1.06698\" stroke=\"#2A7EAC\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><rect x='290.77' y='177.11' width='79.85' height='49.04' id='15' clip-path='url(#cl1_2)' fill=\"#D88C61\" fill-opacity=\"1\" stroke-width=\"1.06698\" stroke=\"#AC582A\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><script type='text/javascript'><![CDATA[document.querySelectorAll('#svg_1')[0].getElementById('14').setAttribute('title','Bootstrap 95% CI: 66 to 72%');document.querySelectorAll('#svg_1')[0].getElementById('15').setAttribute('title','Bootstrap 95% CI: 44 to 53%');]]>\u003c/script><line x1='131.07' y1='131.58' x2='210.92' y2='131.58' id='16' clip-path='url(#cl1_2)' stroke-width=\"6.40187\" stroke=\"#2A7EAC\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#2A7EAC\" fill-opacity=\"1\"/><line x1='290.77' y1='205.13' x2='370.62' y2='205.13' id='17' clip-path='url(#cl1_2)' stroke-width=\"6.40187\" stroke=\"#AC582A\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#AC582A\" fill-opacity=\"1\"/><script type='text/javascript'><![CDATA[document.querySelectorAll('#svg_1')[0].getElementById('16').setAttribute('title','Point prevalence: 69%');document.querySelectorAll('#svg_1')[0].getElementById('17').setAttribute('title','Point prevalence: 48%');]]>\u003c/script><defs><clipPath id='cl1_3'><rect x='0.00' y='0.00' width='432.00' height='432.00'/>\u003c/clipPath>\u003c/defs><g clip-path='url(#cl1_3)'><text x='61.11' y='378.95' id='18' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>0\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text x='51.99' y='291.38' id='19' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>25\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text x='51.99' y='203.81' id='20' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>50\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text x='51.99' y='116.25' id='21' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>75\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text x='42.87' y='28.68' id='22' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>100\u003c/text>\u003c/g><polyline points='72.43,373.26 75.17,373.26' id='23' clip-path='url(#cl1_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='72.43,285.70 75.17,285.70' id='24' clip-path='url(#cl1_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='72.43,198.13 75.17,198.13' id='25' clip-path='url(#cl1_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='72.43,110.56 75.17,110.56' id='26' clip-path='url(#cl1_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='72.43,22.99 75.17,22.99' id='27' clip-path='url(#cl1_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='170.99,393.52 170.99,390.78' id='28' clip-path='url(#cl1_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='330.70,393.52 330.70,390.78' id='29' clip-path='url(#cl1_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><g clip-path='url(#cl1_3)'><text x='140.50' y='407.08' id='30' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>Exposed\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text x='147.07' y='426.52' id='31' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>to ddX\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text x='276.12' y='407.08' id='32' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>Never exposed\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text x='307.55' y='426.52' id='33' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>to ddx\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text transform='translate(19.04,298.12) rotate(-90)' id='34' font-size='13.50pt' font-family='Calibri'>Neuropathy prevalence (%)\u003c/text>\u003c/g><g clip-path='url(#cl1_3)'><text transform='translate(38.48,198.13) rotate(-90)' id='35' font-size='13.50pt' font-family='Calibri'>\u003c/text>\u003c/g>\u003c/g>\u003c/svg>","code":"document.querySelectorAll('#svg_1')[0].getElementById('14').setAttribute('title','Bootstrap 95% CI: 66 to 72%');document.querySelectorAll('#svg_1')[0].getElementById('15').setAttribute('title','Bootstrap 95% CI: 44 to 53%');;document.querySelectorAll('#svg_1')[0].getElementById('16').setAttribute('title','Point prevalence: 69%');document.querySelectorAll('#svg_1')[0].getElementById('17').setAttribute('title','Point prevalence: 48%');","canvas_id":1,"data_id_class":"cl1a335f51574","tooltip_extra_css":"background-color:#000000;color:#FFFFFF;font-family:helvetica;padding:10px;border-radius:10px 20px 10px 20px;","hover_css":"fill:orange;","tooltip_opacity":0.9,"tooltip_offx":10,"tooltip_offy":0,"zoom_max":1,"zoompan":false,"selection_type":"multiple","selected_css":"fill:orange;","width":"70%","padding_bottom":"70%"},"evals":[],"jsHooks":[]}</script>
<p style="font-size:90%;max-width:70%;margin-left:auto;margin-right:auto;">
<b>Figure 1.</b> Point prevalence (with 95% bootstrap confidence intervals) of HIV neuropathy in simulated datasets based on neuropathy prevalence reported by Ellis <em>et al.</em> (2010). Data are shown for patients were/had been on combination antiretroviral therapy (cART), but who have never been exposed to the neurotoxic antiretroviral drugs <em>(Never exposed to ddX; Orange)</em>, and patients who were/had been on cART, and who had been exposed to ddX <em>(Exposed to ddX; Blue)</em>.
</p>
<p><br><br></p>
<p>From the plot, you can clearly see that there was a much (~30%) lower prevalence of HIV neuropathy in those patients never exposed to neurotoxic ddX drugs compared to those who had been exposed <em>(if seeing isnâ€™t believing and you like to see a p-value, then see the table below)</em>. But, while the neuropathy was less common in patients treated with the newer drugs, almost half of the patient still had evidence of peripheral nerve damage; a substantial burden.<br><br></p>
<div id="significance-testing" class="section level4">
<h4>Significance testing</h4>
<table style="width:46%;">
<caption>Pearsonâ€™s Chi-squared test with simulated p-value (based on 999 replicates): <code>ddX_exposure</code> and <code>sn_status</code></caption>
<colgroup>
<col width="23%" />
<col width="6%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Test statistic</th>
<th align="left">df</th>
<th align="left">P value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">58.3</td>
<td align="left">NA</td>
<td align="left">0.001 * * *</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="is-the-neuropathy-still-painful" class="section level3">
<h3>Is the neuropathy still painful?</h3>
<p>As I mentioned earlier, pain is a common symptom of the neuropathy, and this pain causes significant dysfuction and distress. Consequently, having shown that exposure to newer, less neurotoxic treatments is associated with reduced prevalence of HIV neuropathy compared with older drugs, it stands to reason that when neuropathy is present, the severity of the neuropathy associated with these newer drugs may be less than that induced by the older drugs. Therefore, I also looked at the frequency of painful symptoms in <strong>ddX-exposed</strong> and <strong>ddX-naive</strong> patients reported on by Ellis and colleagues (2010) that had at least one clinical sign of peripheral nerve damage (i.e., only patients who had a neuropathy). This new analysis followed exactly the same procedures as those described above, except that I took the data from Table 2 of Ellis <em>et al.</em> (2010) (see below). So, other than showing which data I extracted from Table 2, I have not shown the <em>R</em> scripts for this section (your can find the full <em>.Rmd</em> file on <a href="http://github.com/kamermanpr/second-look-PAIN/ellis-2010">GitHub</a>)<br><br></p>
<div class="figure">
<img src="figures/ellis-2010-table2.jpg" style="display:block;margin-right:auto;margin-left:auto;max-width:100%;" />

</div>
<p><br><br></p>
<p>Here are the data I extracted from Table 2 of Ellis <em>et al.</em> (2010).<br><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#       Extract data from Ellis et al (2010) table 1       #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Extract data </span>
<span class="co"># pain_ddX_exposed: painful sensory neuropathy (pain), and have been exposed to ddX</span>
<span class="co"># Data extracted: Currently using ddX + used ddX in the past</span>
pain_ddX_exposed &lt;-<span class="st"> </span><span class="dv">38</span> +<span class="st"> </span><span class="dv">184</span>  

<span class="co"># pain_free_ddX_exposed: Nonpainful sensory neuropathy (pain_free), and have </span>
<span class="co"># been exposed to ddX</span>
<span class="co"># Data extracted: Currently using ddX + used ddX in the past  </span>
pain_free_ddX_exposed &lt;-<span class="st"> </span><span class="dv">100</span> +<span class="st"> </span><span class="dv">229</span>  

<span class="co"># pain_ddX_naive: Painful sensory neuropathy (pain), and never been exposed to ddX  </span>
<span class="co"># Data extracted: ddX-naive - cART-naive  </span>
pain_ddX_naive &lt;-<span class="st"> </span><span class="dv">113</span> -<span class="st"> </span><span class="dv">29</span>  

<span class="co"># pain_free_ddX_naive: Nonpainful sensory neuropathy (pain_free), and never </span>
<span class="co"># been exposed to ddX  </span>
<span class="co"># Data extracted: ddX-naive - cART-naive  </span>
pain_free_ddX_naive &lt;-<span class="st"> </span><span class="dv">217</span> -<span class="st"> </span><span class="dv">42</span>  

############################################################
<span class="co">#                                                          #</span>
<span class="co">#                 Tabulate extracted data                  #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Put into dataframe</span>
extr_pain &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">Pain =</span> <span class="kw">c</span>(<span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>, <span class="st">&#39;No&#39;</span>),
                   <span class="dt">ddX_exposure =</span> <span class="kw">c</span>(<span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>, <span class="st">&#39;Yes&#39;</span>, <span class="st">&#39;No&#39;</span>),
                   <span class="dt">N =</span> <span class="kw">c</span>(pain_ddX_exposed, pain_ddX_naive, 
                         pain_free_ddX_exposed, pain_free_ddX_naive))

<span class="co"># Tabulate</span>
<span class="kw">pander</span>(extr_pain, <span class="dt">caption =</span> <span class="st">&#39;Summary of data extracted from Table 2 of Ellis et al. (2010)&#39;</span>,
       <span class="dt">justify =</span> <span class="st">&#39;left&#39;</span>,
       <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table style="width:35%;">
<caption>Summary of data extracted from Table 2 of Ellis et al. (2010)</caption>
<colgroup>
<col width="9%" />
<col width="20%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Pain</th>
<th align="left">ddX_exposure</th>
<th align="left">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Yes</td>
<td align="left">Yes</td>
<td align="left">222</td>
</tr>
<tr class="even">
<td align="left">Yes</td>
<td align="left">No</td>
<td align="left">84</td>
</tr>
<tr class="odd">
<td align="left">No</td>
<td align="left">Yes</td>
<td align="left">329</td>
</tr>
<tr class="even">
<td align="left">No</td>
<td align="left">No</td>
<td align="left">175</td>
</tr>
</tbody>
</table>
<p>Following data extraction, I simulated datasets of the number of participants with <em>(pain)</em> and without <em>(pain_free)</em> painful sensory neuropathy in the <em>ddX-naive</em> and <em>ddX-exposed</em> groups, and then calculated and plotted bootstrap 95% confidence intervals.<br><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#                    Simulate datasets                     #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># ddX-naive data</span>
ddX_naive_pain &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;pain&#39;</span>, pain_ddX_naive), 
               <span class="kw">rep</span>(<span class="st">&#39;pain_free&#39;</span>, pain_free_ddX_naive)) %&gt;%<span class="st"> </span><span class="co"># generate the data</span>
<span class="st">    </span><span class="kw">sample</span>(., 
           <span class="dt">size =</span> <span class="kw">length</span>(.), 
           <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="co"># shuffle the pack (for no good reason)</span>

<span class="co"># ddX-exposed data </span>
ddX_exposed_pain &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;pain&#39;</span>, pain_ddX_exposed), 
                 <span class="kw">rep</span>(<span class="st">&#39;pain_free&#39;</span>, pain_free_ddX_exposed))  %&gt;%<span class="st"> </span><span class="co"># generate the data</span>
<span class="st">    </span><span class="kw">sample</span>(., 
           <span class="dt">size =</span> <span class="kw">length</span>(.), 
           <span class="dt">replace =</span> <span class="ot">FALSE</span>) <span class="co"># shuffle the pack (for no good reason)</span>

############################################################
<span class="co">#                                                          #</span>
<span class="co">#                Tabulate simulated data                   #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Put into dataframe</span>
sim &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">Group =</span> <span class="kw">c</span>(<span class="st">&#39;ddX_exposure&#39;</span>, <span class="st">&#39;ddX_naive&#39;</span>),
                     <span class="st">`</span><span class="dt">Pain (n)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(ddX_exposed_pain[ddX_exposed_pain ==<span class="st"> &#39;pain&#39;</span>]), 
                                          <span class="kw">length</span>(ddX_naive_pain[ddX_naive_pain ==<span class="st"> &#39;pain&#39;</span>])),
                     <span class="st">`</span><span class="dt">No pain (n)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(ddX_exposed_pain[ddX_exposed_pain ==<span class="st"> &#39;pain_free&#39;</span>]),
                                             <span class="kw">length</span>(ddX_naive_pain[ddX_naive_pain ==<span class="st"> &#39;pain_free&#39;</span>])),
                     <span class="st">`</span><span class="dt">Total (n)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">length</span>(ddX_exposed_pain),
                                     <span class="kw">length</span>(ddX_naive_pain))) %&gt;%
<span class="st">    </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span> *<span class="st"> </span>(<span class="st">`</span><span class="dt">Pain (n)</span><span class="st">`</span> /<span class="st"> `</span><span class="dt">Total (n)</span><span class="st">`</span>)))

<span class="co"># Tabulate</span>
<span class="kw">pander</span>(sim, <span class="dt">caption =</span> <span class="st">&#39;Summary of pain prevalence in simulated datasets&#39;</span>,
       <span class="dt">justify =</span> <span class="st">&#39;left&#39;</span>,
       <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table style="width:92%;">
<caption>Summary of pain prevalence in simulated datasets</caption>
<colgroup>
<col width="18%" />
<col width="15%" />
<col width="19%" />
<col width="16%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Group</th>
<th align="left">Pain (n)</th>
<th align="left">No pain (n)</th>
<th align="left">Total (n)</th>
<th align="left">Prevalence (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ddX_exposure</td>
<td align="left">222</td>
<td align="left">329</td>
<td align="left">551</td>
<td align="left">40</td>
</tr>
<tr class="even">
<td align="left">ddX_naive</td>
<td align="left">84</td>
<td align="left">175</td>
<td align="left">259</td>
<td align="left">32</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#        Bootstrap SN prevalence (resampling = 999)        #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Step 1: Define function &#39;bootstrp&#39; (already done)</span>

<span class="co"># Step 2: Run the function</span>
ddX_exposed_pain_2 &lt;-<span class="st"> </span><span class="kw">bootstrp</span>(ddX_exposed_pain)
ddX_naive_pain_2 &lt;-<span class="st"> </span><span class="kw">bootstrp</span>(ddX_naive_pain)

<span class="co"># Step 3: Create a vector of neuropathy prevalence data for each item </span>
<span class="co"># in the output of &#39;bootstrp&#39;</span>
ddX_exposed_pain_3 &lt;-<span class="st"> </span><span class="kw">sapply</span>(ddX_exposed_pain_2,
                          function(y) <span class="kw">round</span>(<span class="dv">100</span> *<span class="st"> </span>(<span class="kw">length</span>(y[y ==<span class="st"> &#39;pain&#39;</span>]) /<span class="st"> </span><span class="kw">length</span>(y))))
ddX_naive_pain_3 &lt;-<span class="st"> </span><span class="kw">sapply</span>(ddX_naive_pain_2,
                          function(y) <span class="kw">round</span>(<span class="dv">100</span> *<span class="st"> </span>(<span class="kw">length</span>(y[y ==<span class="st"> &#39;pain&#39;</span>]) /<span class="st"> </span><span class="kw">length</span>(y))))

<span class="co"># Step 4: Get the lower (0.025) and upper (0.975) limits of the </span>
<span class="co"># vector of prevalence data</span>
ddX_exposed_pain_4 &lt;-<span class="st"> </span><span class="kw">quantile</span>(ddX_exposed_pain_3,
                          <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))
ddX_naive_pain_4 &lt;-<span class="st"> </span><span class="kw">quantile</span>(ddX_naive_pain_3,
                        <span class="dt">probs =</span> <span class="kw">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))

############################################################
<span class="co">#                                                          #</span>
<span class="co">#                Tabulate bootstrap outputs                #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Step 1: Prepare dataframe of simulated datasets (bootstrap sample)</span>
df_pain &lt;-<span class="st"> </span><span class="kw">right_join</span>(<span class="kw">data_frame</span>(<span class="dt">N =</span> <span class="dv">1</span>:<span class="kw">length</span>(ddX_naive_pain),
                             <span class="dt">ddX_naive =</span> <span class="kw">factor</span>(ddX_naive_pain)),
                  <span class="kw">data_frame</span>(<span class="dt">N =</span> <span class="dv">1</span>:<span class="kw">length</span>(ddX_exposed_pain),
                             <span class="dt">ddX_exposed =</span> <span class="kw">factor</span>(ddX_exposed_pain))) %&gt;%<span class="st"> </span><span class="co"># make a dataframe</span>
<span class="st">    </span><span class="kw">gather</span>(Group, Pain, ddX_naive, ddX_exposed) %&gt;%<span class="st"> </span><span class="co"># gather columns</span>
<span class="st">    </span><span class="kw">select</span>(Group, Pain) %&gt;%<span class="st"> </span><span class="co"># select required columns</span>
<span class="st">    </span><span class="kw">filter</span>(!<span class="kw">is.na</span>(Pain)) %&gt;%<span class="st"> </span><span class="co"># remove NA from join</span>
<span class="st">    </span><span class="kw">group_by</span>(Group, Pain) %&gt;%<span class="st"> </span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">Count =</span> <span class="kw">n</span>()) %&gt;%<span class="st"> </span><span class="co"># get counts from group_by</span>
<span class="st">    </span><span class="kw">spread</span>(Pain, Count) %&gt;%<span class="st"> </span><span class="co"># spread the Neuropathy column</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Total (n)</span><span class="st">`</span> =<span class="st"> </span>pain +<span class="st"> </span>pain_free,
           <span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">round</span>(<span class="dv">100</span> *<span class="st"> </span>(pain /<span class="st"> `</span><span class="dt">Total (n)</span><span class="st">`</span>))) %&gt;%
<span class="st">    </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">Pain (n)</span><span class="st">`</span>=<span class="st"> </span>pain, 
           <span class="st">`</span><span class="dt">No pain (n)</span><span class="st">`</span> =<span class="st"> </span>pain_free) <span class="co"># rename columns</span>

<span class="co"># Step 2: Add the bootstrap CI data to &#39;df_pain&#39;</span>
df2_pain &lt;-<span class="st"> </span>df_pain %&gt;%
<span class="st">    </span><span class="kw">bind_cols</span>(<span class="kw">data.frame</span>(<span class="dt">Lower_95CI =</span> <span class="kw">c</span>(ddX_exposed_pain_4[<span class="dv">1</span>], ddX_naive_pain_4[<span class="dv">1</span>]),
                         <span class="kw">data.frame</span>(<span class="dt">Upper_95CI =</span> <span class="kw">c</span>(ddX_exposed_pain_4[<span class="dv">2</span>], ddX_naive_pain_4[<span class="dv">2</span>])))) %&gt;%
<span class="st">    </span><span class="kw">rename</span>(<span class="st">`</span><span class="dt">Lower 95% CI</span><span class="st">`</span> =<span class="st"> </span>Lower_95CI,
           <span class="st">`</span><span class="dt">Upper 95% CI</span><span class="st">`</span> =<span class="st"> </span>Upper_95CI)

<span class="co"># Step 3: Print table</span>
<span class="kw">pander</span>(df2_pain, <span class="dt">caption =</span> <span class="st">&#39;Painful neuropathy prevalence (95% bootstrap confidence interval) in simulated datasets&#39;</span>,
       <span class="dt">justify =</span> <span class="st">&#39;left&#39;</span>,
       <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table>
<caption>Painful neuropathy prevalence (95% bootstrap confidence interval) in simulated datasets</caption>
<colgroup>
<col width="12%" />
<col width="11%" />
<col width="14%" />
<col width="12%" />
<col width="17%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Group</th>
<th align="left">Pain (n)</th>
<th align="left">No pain (n)</th>
<th align="left">Total (n)</th>
<th align="left">Prevalence (%)</th>
<th align="left">Lower 95% CI</th>
<th align="left">Upper 95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">ddX_exposed</td>
<td align="left">222</td>
<td align="left">329</td>
<td align="left">551</td>
<td align="left">40</td>
<td align="left">36</td>
<td align="left">44</td>
</tr>
<tr class="even">
<td align="left">ddX_naive</td>
<td align="left">84</td>
<td align="left">175</td>
<td align="left">259</td>
<td align="left">32</td>
<td align="left">27</td>
<td align="left">38</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#                   Plot bootstrap data                    #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Step 1: Format df2_pain for plotting, including tooltip columns </span>
<span class="co"># for interactive graph labelling</span>
Max &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">Max =</span> <span class="kw">c</span>(<span class="kw">max</span>(ddX_exposed_pain_3), <span class="kw">max</span>(ddX_naive_pain_3)))
Min &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">Min =</span> <span class="kw">c</span>(<span class="kw">min</span>(ddX_exposed_pain_3), <span class="kw">min</span>(ddX_naive_pain_3)))
tooltip_prev &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">tooltip_prev =</span> <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&#39;Point prevalence: &#39;</span>,
                                        df2_pain$<span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span>[<span class="dv">1</span>], <span class="st">&#39;%&#39;</span>),
                                 <span class="kw">paste0</span>(<span class="st">&#39;Point prevalence: &#39;</span>, 
                                        df2_pain$<span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span>[<span class="dv">2</span>], <span class="st">&#39;%&#39;</span>)))
tooltip_95CI &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">tooltip_95CI =</span> <span class="kw">c</span>(<span class="kw">paste0</span>(<span class="st">&#39;Bootstrap 95% CI: &#39;</span>,
                                                   df2_pain$<span class="st">`</span><span class="dt">Lower 95% CI</span><span class="st">`</span>[<span class="dv">1</span>], 
                                                   <span class="st">&#39; to &#39;</span>,
                                                   df2_pain$<span class="st">`</span><span class="dt">Upper 95% CI</span><span class="st">`</span>[<span class="dv">1</span>], <span class="st">&#39;%&#39;</span>),
                                            <span class="kw">paste0</span>(<span class="st">&#39;Bootstrap 95% CI: &#39;</span>,
                                                   df2_pain$<span class="st">`</span><span class="dt">Lower 95% CI</span><span class="st">`</span>[<span class="dv">2</span>], 
                                                   <span class="st">&#39; to &#39;</span>,
                                                   df2_pain$<span class="st">`</span><span class="dt">Upper 95% CI</span><span class="st">`</span>[<span class="dv">2</span>], <span class="st">&#39;%&#39;</span>)))

df2_pain_plot &lt;-<span class="st"> </span>df2_pain %&gt;%
<span class="st">    </span><span class="kw">select</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>:<span class="dv">7</span>)) %&gt;%
<span class="st">    </span><span class="kw">rename</span>(<span class="dt">Prevalence =</span> <span class="st">`</span><span class="dt">Prevalence (%)</span><span class="st">`</span>,
           <span class="dt">Lower_95CI =</span> <span class="st">`</span><span class="dt">Lower 95% CI</span><span class="st">`</span>,
           <span class="dt">Upper_95CI =</span> <span class="st">`</span><span class="dt">Upper 95% CI</span><span class="st">`</span>) %&gt;%
<span class="st">    </span><span class="kw">bind_cols</span>(Max, Min, tooltip_prev, tooltip_95CI)

<span class="co"># Step 2: Set palette</span>
palette_dark &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#2a7eac&#39;</span>, <span class="st">&#39;#ac582a&#39;</span>)
palette_light &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;#61add8&#39;</span>, <span class="st">&#39;#d88c61&#39;</span>)

<span class="co"># Step 3: Plot using interactive geoms from &#39;ggiraph&#39; package</span>
sn_pain &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df2_pain_plot,
                 <span class="kw">aes</span>(<span class="dt">x =</span> Group,
                     <span class="dt">y =</span> Prevalence,
                     <span class="dt">fill =</span> Group,
                     <span class="dt">color =</span> Group)) +
<span class="st">    </span><span class="kw">geom_rect_interactive</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Min, 
                      <span class="dt">ymax =</span> Max, 
                      <span class="dt">tooltip =</span> tooltip_95CI),
                      <span class="dt">xmin =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">1.75</span>), 
                      <span class="dt">xmax =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">2.25</span>)) +
<span class="st">    </span><span class="kw">geom_segment_interactive</span>(<span class="kw">aes</span>(<span class="dt">y =</span> Prevalence,
                                 <span class="dt">yend =</span> Prevalence,
                                 <span class="dt">x =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="fl">1.75</span>), 
                                 <span class="dt">xend =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">2.25</span>),
                                 <span class="dt">tooltip =</span> tooltip_prev),
                             <span class="dt">size =</span> <span class="dv">3</span>) +
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&#39;Painful neuropathy prevalence (%)</span><span class="ch">\n</span><span class="st">&#39;</span>) +
<span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;Exposed</span><span class="ch">\n</span><span class="st">to ddX&#39;</span>, <span class="st">&#39;Never exposed</span><span class="ch">\n</span><span class="st">to ddx&#39;</span>)) +
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>)) +
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> palette_light) +
<span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> palette_dark) +
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&#39;none&#39;</span>,
          <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
          <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;#dddddd&quot;</span>),
          <span class="dt">plot.title =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.ticks =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;#dddddd&quot;</span>),
          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>),
          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>))
<span class="co"># Step 4: Plot interactive graph</span>
extra_css &lt;-<span class="st"> &quot;background-color:#000000;color:#FFFFFF;font-family:helvetica;padding:10px;border-radius:10px 20px 10px 20px;&quot;</span>
<span class="kw">ggiraph</span>(<span class="dt">code =</span> <span class="kw">print</span>(sn_pain), 
        <span class="dt">tooltip_extra_css =</span> extra_css)</code></pre></div>
<div id="htmlwidget-039acd625e59e2ebd1c5" style="width:960px;height:500px;" class="ggiraph html-widget"></div>
<script type="application/json" data-for="htmlwidget-039acd625e59e2ebd1c5">{"x":{"html":"<?xml version='1.0' encoding='UTF-8'?><svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' id='svg_2' viewBox='0 0 432.00 432.00' width='432.00' height='432.00'><g><defs><clipPath id='cl2_0'><rect x='0.00' y='432.00' width='0.00' height='0.00'/>\u003c/clipPath>\u003c/defs><rect x='0.00' y='0.00' width='432.00' height='432.00' id='1' clip-path='url(#cl2_0)' fill=\"#FFFFFF\" fill-opacity=\"1\" stroke-width=\"0.75\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/><defs><clipPath id='cl2_1'><rect x='0.00' y='0.00' width='432.00' height='432.00'/>\u003c/clipPath>\u003c/defs><rect x='0.00' y='0.00' width='432.00' height='432.00' id='2' clip-path='url(#cl2_1)' fill=\"#FFFFFF\" fill-opacity=\"1\" stroke-width=\"1.06698\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"round\"/><defs><clipPath id='cl2_2'><rect x='75.17' y='5.48' width='351.35' height='385.30'/>\u003c/clipPath>\u003c/defs><polyline points='75.17,329.48 426.52,329.48' id='3' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,241.91 426.52,241.91' id='4' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,154.34 426.52,154.34' id='5' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,66.78 426.52,66.78' id='6' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"0.533489\" stroke=\"#FFFFFF\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,373.26 426.52,373.26' id='7' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,285.70 426.52,285.70' id='8' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,198.13 426.52,198.13' id='9' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,110.56 426.52,110.56' id='10' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='75.17,22.99 426.52,22.99' id='11' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='170.99,390.78 170.99,5.48' id='12' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='330.70,390.78 330.70,5.48' id='13' clip-path='url(#cl2_2)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><rect x='131.07' y='212.14' width='79.85' height='45.54' id='14' clip-path='url(#cl2_2)' fill=\"#61ADD8\" fill-opacity=\"1\" stroke-width=\"1.06698\" stroke=\"#2A7EAC\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><rect x='290.77' y='226.15' width='79.85' height='66.55' id='15' clip-path='url(#cl2_2)' fill=\"#D88C61\" fill-opacity=\"1\" stroke-width=\"1.06698\" stroke=\"#AC582A\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><script type='text/javascript'><![CDATA[document.querySelectorAll('#svg_2')[0].getElementById('14').setAttribute('title','Bootstrap 95% CI: 36 to 44%');document.querySelectorAll('#svg_2')[0].getElementById('15').setAttribute('title','Bootstrap 95% CI: 27 to 38%');]]>\u003c/script><line x1='131.07' y1='233.15' x2='210.92' y2='233.15' id='16' clip-path='url(#cl2_2)' stroke-width=\"6.40187\" stroke=\"#2A7EAC\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#2A7EAC\" fill-opacity=\"1\"/><line x1='290.77' y1='261.18' x2='370.62' y2='261.18' id='17' clip-path='url(#cl2_2)' stroke-width=\"6.40187\" stroke=\"#AC582A\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\" fill=\"#AC582A\" fill-opacity=\"1\"/><script type='text/javascript'><![CDATA[document.querySelectorAll('#svg_2')[0].getElementById('16').setAttribute('title','Point prevalence: 40%');document.querySelectorAll('#svg_2')[0].getElementById('17').setAttribute('title','Point prevalence: 32%');]]>\u003c/script><defs><clipPath id='cl2_3'><rect x='0.00' y='0.00' width='432.00' height='432.00'/>\u003c/clipPath>\u003c/defs><g clip-path='url(#cl2_3)'><text x='61.11' y='378.95' id='18' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>0\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text x='51.99' y='291.38' id='19' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>25\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text x='51.99' y='203.81' id='20' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>50\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text x='51.99' y='116.25' id='21' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>75\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text x='42.87' y='28.68' id='22' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>100\u003c/text>\u003c/g><polyline points='72.43,373.26 75.17,373.26' id='23' clip-path='url(#cl2_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='72.43,285.70 75.17,285.70' id='24' clip-path='url(#cl2_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='72.43,198.13 75.17,198.13' id='25' clip-path='url(#cl2_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='72.43,110.56 75.17,110.56' id='26' clip-path='url(#cl2_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='72.43,22.99 75.17,22.99' id='27' clip-path='url(#cl2_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='170.99,393.52 170.99,390.78' id='28' clip-path='url(#cl2_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><polyline points='330.70,393.52 330.70,390.78' id='29' clip-path='url(#cl2_3)' fill=\"none\" stroke-width=\"1.06698\" stroke=\"#DDDDDD\" stroke-opacity=\"1\" stroke-linejoin=\"round\" stroke-linecap=\"butt\"/><g clip-path='url(#cl2_3)'><text x='140.50' y='407.08' id='30' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>Exposed\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text x='147.07' y='426.52' id='31' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>to ddX\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text x='276.12' y='407.08' id='32' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>Never exposed\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text x='307.55' y='426.52' id='33' font-size='13.50pt' fill=\"#4D4D4D\" fill-opacity=\"1\" font-family='Calibri'>to ddx\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text transform='translate(19.04,324.37) rotate(-90)' id='34' font-size='13.50pt' font-family='Calibri'>Painful neuropathy prevalence (%)\u003c/text>\u003c/g><g clip-path='url(#cl2_3)'><text transform='translate(38.48,198.13) rotate(-90)' id='35' font-size='13.50pt' font-family='Calibri'>\u003c/text>\u003c/g>\u003c/g>\u003c/svg>","code":"document.querySelectorAll('#svg_2')[0].getElementById('14').setAttribute('title','Bootstrap 95% CI: 36 to 44%');document.querySelectorAll('#svg_2')[0].getElementById('15').setAttribute('title','Bootstrap 95% CI: 27 to 38%');;document.querySelectorAll('#svg_2')[0].getElementById('16').setAttribute('title','Point prevalence: 40%');document.querySelectorAll('#svg_2')[0].getElementById('17').setAttribute('title','Point prevalence: 32%');","canvas_id":2,"data_id_class":"cl1a33272b54aa","tooltip_extra_css":"background-color:#000000;color:#FFFFFF;font-family:helvetica;padding:10px;border-radius:10px 20px 10px 20px;","hover_css":"fill:orange;","tooltip_opacity":0.9,"tooltip_offx":10,"tooltip_offy":0,"zoom_max":1,"zoompan":false,"selection_type":"multiple","selected_css":"fill:orange;","width":"70%","padding_bottom":"70%"},"evals":[],"jsHooks":[]}</script>
<p style="font-size:90%;max-width:70%;margin-right:auto;margin-left:auto;">
<b>Figure 1.</b> Point prevalence (with 95% bootstrap confidence intervals) of painful HIV neuropathy in simulated datasets based on the prevalence of painfulperipheral neuropathy reported by Ellis <em>et al.</em> (2010). Data are shown for patients with a clinically diagnosed neuropathy, and were/had been on combination antiretroviral therapy (cART), but who have never been exposed to the neurotoxic antiretroviral drugs <em>(Never exposed to ddX; Orange)</em>, and patients who were/had been on cART, and who had been exposed to ddX <em>(Exposed to ddX; Blue)</em>.
</p>
<p><br><br></p>
<p>From the plot, you can see that there was a slightly lower prevalence of painful HIV neuropathy in those patients never exposed to neurotoxic ddX drugs compared to those who had been exposed <em>(there is overlap of the lower limit of the ddX-exposed group and the upper limit of the ddX-naive group)</em>. Like before, if seeing isnâ€™t believing and you like to see a <em>p-value</em>, then see the table below. So, the newer drugs do appear to reduce the severity of the painful symptoms of the neuropathy compared with older ddX drugs, but like the findings for neuropathy <em>per se</em>, there still was a high burden of pain in those with neuropathy and who had only ever been exposed to newer treatments.<br><br></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################################################
<span class="co">#                                                          #</span>
<span class="co">#                   Significance testing                   #</span>
<span class="co">#                                                          #</span>
############################################################
<span class="co"># Organise data for chi-square test</span>
df_pain_chi &lt;-<span class="st"> </span><span class="kw">right_join</span>(<span class="kw">data_frame</span>(<span class="dt">N =</span> <span class="dv">1</span>:<span class="kw">length</span>(ddX_naive_pain),
                             <span class="dt">ddX_naive =</span> <span class="kw">factor</span>(ddX_naive_pain)),
                  <span class="kw">data_frame</span>(<span class="dt">N =</span> <span class="dv">1</span>:<span class="kw">length</span>(ddX_exposed_pain),
                             <span class="dt">ddX_exposed =</span> <span class="kw">factor</span>(ddX_exposed_pain))) %&gt;%
<span class="st">    </span><span class="kw">gather</span>(Group, Pain, ddX_naive, ddX_exposed) %&gt;%
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Group =</span> <span class="kw">factor</span>(Group),
           <span class="dt">Pain =</span> <span class="kw">factor</span>(Pain)) %&gt;%
<span class="st">    </span><span class="kw">select</span>(Group, Pain)

ddX_exposure &lt;-<span class="st"> </span>df_pain_chi[[<span class="dv">1</span>]]
pain_status &lt;-<span class="st"> </span>df_pain_chi[[<span class="dv">2</span>]]

<span class="co"># Perform chi-square with simulated p-value, and tabulate output</span>
<span class="kw">pander</span>(<span class="kw">chisq.test</span>(<span class="dt">x =</span> ddX_exposure, 
                  <span class="dt">y =</span> pain_status,
                  <span class="dt">simulate.p.value =</span> <span class="ot">TRUE</span>, <span class="dt">B =</span> <span class="dv">999</span>),
    <span class="dt">justify =</span> <span class="st">&#39;left&#39;</span>,
    <span class="dt">split.tables =</span> <span class="ot">Inf</span>)</code></pre></div>
<table style="width:43%;">
<caption>Pearsonâ€™s Chi-squared test with simulated p-value (based on 999 replicates): <code>ddX_exposure</code> and <code>pain_status</code></caption>
<colgroup>
<col width="23%" />
<col width="6%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Test statistic</th>
<th align="left">df</th>
<th align="left">P value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">4.628</td>
<td align="left">NA</td>
<td align="left">0.034 *</td>
</tr>
</tbody>
</table>
</div>
<div id="take-home-message" class="section level3">
<h3>Take-home message</h3>
<p><em><strong>HIV neuropathy is not going to disappear anytime soon.</strong></em></p>
<p>While the frequency of HIV neuropathy, and the painful symptoms of the neuropathy, was markedly reduced in patients on modern treatment regimens compared to those exposed to older, neurotoxic treatments, the burden of neuropathy (and pain) was <em>still unacceptably high</em>. These data indicate that the burden of this chronic complication of HIV infection may well decrease over time, but healthcare professionals still need to be cognisant that many of their patients, even if never exposed to ddX drugs, are still at risk of neuropathy, and its painful sequela.</p>
<hr />
</div>
<div id="analysis-script" class="section level3">
<h3>Analysis script</h3>
<p>The analysis script for this blog post can be found under the <em>ellis-2010</em> subdirectory of the <em><a href="http://github.com/kamermanpr/second-look-PAIN">second-look-PAIN</a></em> GitHub repository.</p>
</div>
<div id="citation" class="section level3">
<h3>Citation</h3>
<p>Peter Kamerman. (2016). HIV neuropathy: Going, goingâ€¦but not gone. Figshare DOI: <a href="http://dx.doi.org/10.6084/m9.figshare.2656255">10.6084/m9.figshare.2656255</a></p>
<hr />
</div>
<div id="session-information" class="section level3">
<h3>Session information</h3>
<pre><code>## R version 3.2.4 (2016-03-10)
## Platform: x86_64-apple-darwin13.4.0 (64-bit)
## Running under: OS X 10.11.6 (El Capitan)
## 
## locale:
## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
## 
## attached base packages:
## [1] grid      stats     graphics  grDevices utils     datasets  methods  
## [8] base     
## 
## other attached packages:
##  [1] gdtools_0.0.7 ggiraph_0.3.1 svglite_1.1.0 pander_0.6.0  knitr_1.14   
##  [6] tidyr_0.6.0   dplyr_0.5.0   readr_1.0.0   scales_0.4.0  ggplot2_2.1.0
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_0.12.7        xml2_1.0.0         magrittr_1.5      
##  [4] munsell_0.4.3      colorspace_1.2-6   R6_2.1.3          
##  [7] stringr_1.1.0      plyr_1.8.4         tools_3.2.4       
## [10] gtable_0.2.0       R.oo_1.20.0        rvg_0.1.0         
## [13] DBI_0.5            htmltools_0.3.5    lazyeval_0.2.0    
## [16] yaml_2.1.13        assertthat_0.1     digest_0.6.10     
## [19] tibble_1.2         formatR_1.4        R.utils_2.3.0     
## [22] htmlwidgets_0.7    evaluate_0.9       rmarkdown_1.0.9013
## [25] labeling_0.3       stringi_1.1.1      R.methodsS3_1.7.1 
## [28] jsonlite_1.0</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
